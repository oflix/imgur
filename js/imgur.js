!function(e,t){"use strict";"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.Imgur=t()}(this,function(){"use strict";var t=function(e){if(!(this&&this instanceof t))return new t(e);if(e||(e={}),!e.clientid)throw"Provide a valid Client Id here: https://api.imgur.com/";this.clientid=e.clientid,this.endpoint="https://api.imgur.com/3/image",this.callback=e.callback||void 0,this.dropzone=document.querySelectorAll(".dropzone"),this.info=document.querySelectorAll(".info"),this.run()};return t.prototype={createEls:function(e,t,i){var a,n=document.createElement(e);for(a in t)t.hasOwnProperty(a)&&(n[a]=t[a]);return i&&n.appendChild(document.createTextNode(i)),n},insertAfter:function(e,t){e.parentNode.insertBefore(t,e.nextSibling)},post:function(e,t,i){var a=new XMLHttpRequest;a.open("POST",e,!0),a.setRequestHeader("Authorization","Client-ID "+this.clientid),a.onreadystatechange=function(){if(4===this.readyState){if(!(200<=this.status&&this.status<300))throw new Error(this.status+" - "+this.statusText);var t="";try{t=JSON.parse(this.responseText)}catch(e){t=this.responseText}i.call(window,t)}},a.send(t),a=null},createDragZone:function(){var t,i,a;t=this.createEls("p",{},"Drop Image File Here"),i=this.createEls("p",{},"Or click here to select image"),a=this.createEls("input",{type:"file",className:"input",accept:"image/*"}),Array.prototype.forEach.call(this.info,function(e){e.appendChild(t),e.appendChild(i)}.bind(this)),Array.prototype.forEach.call(this.dropzone,function(e){e.appendChild(a),this.status(e),this.upload(e)}.bind(this))},loading:function(){var e,t,i;e=this.createEls("div",{className:"loading-modal"}),t=this.createEls("table",{className:"loading-table"}),i=this.createEls("img",{className:"loading-image",src:"./loading-spin.svg"}),e.appendChild(t),t.appendChild(i),document.body.appendChild(e)},status:function(e){var t=this.createEls("div",{className:"status"});this.insertAfter(e,t)},matchFiles:function(e,t){var i=t.nextSibling;if(e.type.match(/image/)&&"image/svg+xml"!==e.type){document.body.classList.add("loading"),i.classList.remove("bg-success","bg-danger"),i.innerHTML="";var a=new FormData;a.append("image",e),this.post(this.endpoint,a,function(e){document.body.classList.remove("loading"),"function"==typeof this.callback&&this.callback.call(this,e)}.bind(this))}else i.classList.remove("bg-success"),i.classList.add("bg-danger"),i.innerHTML="Invalid archive"},upload:function(i){var t,a,n,s;i.addEventListener("change",function(e){if(e.target&&"INPUT"===e.target.nodeName&&"file"===e.target.type)for(a=e.target.files,n=0,s=a.length;n<s;n+=1)t=a[n],this.matchFiles(t,i)}.bind(this),!1),["dragenter","dragleave","dragover","drop"].map(function(t){i.addEventListener(t,function(e){e.target&&"INPUT"===e.target.nodeName&&"file"===e.target.type&&("dragleave"===t||"drop"===t?e.target.parentNode.classList.remove("dropzone-dragging"):e.target.parentNode.classList.add("dropzone-dragging"))},!1)})},run:function(){document.querySelector(".loading-modal")||this.loading(),this.createDragZone()}},t});
